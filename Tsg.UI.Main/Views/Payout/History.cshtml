@using System.Globalization
@using Tsg.UI.Main.App_LocalResources
@model Tsg.UI.Main.Models.PayoutSearchViewModel
@{
    ViewBag.Title = "Payment History";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}

<div class="row">
    <section class="panel">
        <header class="panel-heading" data-panel-toggle="">
            <div class="panel-actions">
                <a href="#" class="panel-action panel-action-toggle" data-panel-toggle=""></a>
            </div>

            <h2 class="panel-title">Payment History</h2>
            <p class="panel-subtitle"></p>
        </header>
        <script src="/Content/assets/vendor/jquery/jquery.js"></script>

        <div class="panel-body" style="display: block;">
            @if (Model.Payments != null)
            {
                var hiddenClass = "hidden-xs";
                string[] crypto = { "BTC", "ETH", "XAU" };

                <div class="">
                    <table class="table table-bordered table-striped table-condensed mb-none" id="dt-payout-history">
                        <thead>
                            <tr>
                                <th>Reference</th>
                                <th>Beneficiary Name</th>
                                <th>Amount</th>
                                <th>Value Date</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.Payments)
                            {
                            <tr style="@(item.Status.Equals("Voided")?"text-decoration: line-through;":"")">
                                <td class="@hiddenClass">
                                    @*@Html.DisplayFor(modelItem => item.PaymentReference)*@
                                    @Html.ActionLink(item.PaymentReference, "Details", "Payout", new { id = item.PaymentId }, new { @class = "" })
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.BeneficiaryName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.AmountTextWithCurrencyCode)
                                </td>
                                <td>
                                    @*@Html.DisplayFor(modelItem => item.ValueDate.Date)*@
                                    @String.Format("{0:MMM dd, yyyy}", item.ValueDate)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Status)
                                </td>
                                <td>
                                    @*@Html.DisplayFor(modelItem => item.CreatedTime)*@
                                    @String.Format("{0:MMM dd, yyyy}", item.CreatedTime)
                                </td>
                                <td>
                                    @*@Html.ActionLink(GlobalRes.Shared_InstantPaymentListPage_Details, "Details", "Payout", new { id = item.PaymentId }, new { @class = "mb-xs btn btn-xs btn-primary" })*@
                                    @Html.ActionLink("Copy", "Create", "Payout", new { id = item.PaymentId }, new { @class = "mb-xs btn btn-xs btn-primary" })


                                    @if (item.Status != null && item.Status.Equals("Created"))
                                    {
                                        @Html.ActionLink("Approve", "Submit", "Payout", new { id = item.PaymentId }, new { @class = "mb-xs btn btn-xs btn-success" })
                                        @Html.ActionLink("Delete", "Delete", "Payout", new { id = item.PaymentId }, new { @class = "mb-xs btn btn-xs btn-danger" })
                                    }

                                    @*@if (item.Status != null && item.Status.Equals("Submitted To Bank"))
                                    {
                                        @Html.ActionLink("Delete", "Delete", "Payout", new { id = item.PaymentId }, new { @class = "mb-xs btn btn-xs btn-danger" })
                                    }*@

                                    @*@Html.ActionLink("Delete", "Delete", "Payout", new { id = item.PaymentId }, new { @class = "mb-xs btn btn-xs btn-danger" })*@
                                    @*else
        {
            @Html.ActionLink(GlobalRes.Shared_InstantPaymentListPage_Repeat, "Create", "Payment", new { id = item.PaymentId }, new { @class = "mb-xs btn btn-xs btn-info" })
        }*@

                                </td>
                            </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }


            <div>
                <a class="btn btn-success" href="/Payout/Create">New Payment</a>
            </div>
            @if (CultureInfo.CurrentCulture.Name.Contains("PH"))
            {
                <script type="text/javascript">
                    $(window).rea(function () {
                        $('#datatable-default-history').DataTable().destroy();
                        var dt = $('#datatable-default-history').DataTable({
                            responsive: true,
                            order: [[5, "desc"]],
                            "oLanguage": {
                                "sEmptyTable": "Walang impormasyon",
                                "sInfo": "_START_ ng _END_ kabuuang _TOTAL_ na mga pahina",
                                "sInfoEmpty": "0 ng kabuuang 0 mga entry",
                                "sInfoFiltered": "(natagpuan mula sa _MAX_ inskripsyon)",
                                "sInfoPostFix": "",
                                "sInfoThousands": ".",
                                "sLengthMenu": "Ipakita ang _MENU_ item sa pahina",
                                "sLoadingRecords": "Coefficient of activity...",
                                "sProcessing": "Asahan...",
                                "sSearch": "_INPUT_",
                                "sSearchPlaceholder": "Paghahanap",
                                "sZeroRecords": "Walang impormasyon.",
                                "oPaginate": {
                                    "sFirst": "Ang una",
                                    "sPrevious": "Ang huling",
                                    "sNext": "Sumusunod",
                                    "sLast": "Nakaraan"
                                }
                            }
                        });
                        $(".dataTables_filter input").attr("placeholder", "Paghahanap");
                        dt.draw();
                    });
                </script>
            }
            else
            {
                <script type="text/javascript">
                    $(window).load(function () {
                    var lang = '@CultureInfo.CurrentCulture.TwoLetterISOLanguageName';
                    if (lang === 'ru') {
                        $('#datatable-default-history').DataTable().destroy();
                        var dt = $('#datatable-default-history').DataTable({
                            responsive: true,
                            order: [[5, "desc"]],
                            "oLanguage": {
                                "sEmptyTable": "Нет данных",
                                "sInfo": "_START_ из _END_ всего _TOTAL_ страниц",
                                "sInfoEmpty": "0 из 0 всего 0 записей",
                                "sInfoFiltered": "(наидено из _MAX_ записей)",
                                "sInfoPostFix": "",
                                "sInfoThousands": ".",
                                "sLengthMenu": "Отображать _MENU_ записей на странице",
                                "sLoadingRecords": "Загрузка...",
                                "sProcessing": "Подождите...",
                                "sSearch": "_INPUT_",
                                //"searchPlaceholder": "Поиск",
                                "sSearchPlaceholder": "Поиск",
                                "sZeroRecords": "Нет данных.",
                                "oPaginate": {
                                    "sFirst": "Первая",
                                    "sPrevious": "Последняя",
                                    "sNext": "Следующая",
                                    "sLast": "Предыдущая"
                                }
                            }
                        });
                        $(".dataTables_filter input").attr("placeholder", "Поиск");
                        dt.draw();
                    }
                    else if (lang === 'fr') {
                        $('#datatable-default-history').DataTable().destroy();
                        var dt = $('#datatable-default-history').DataTable({
                            responsive: true,
                            order: [[5, "desc"]],
                            "oLanguage": {
                                "sEmptyTable": "Aucune information",
                                "sInfo": "_START_ de la _END_ total _TOTAL_ pages",
                                "sInfoEmpty": "0 de la 0 total 0 inscription",
                                "sInfoFiltered": "(trouvé à partir de _MAX_ inscription)",
                                "sInfoPostFix": "",
                                "sInfoThousands": ".",
                                "sLengthMenu": "Afficher les éléments _MENU_ sur la page",
                                "sLoadingRecords": "Coefficient d'activité...",
                                "sProcessing": "Attendre...",
                                "sSearch": "_INPUT_",
                                "sSearchPlaceholder": "Rechercher",
                                "sZeroRecords": "Aucune information.",
                                "oPaginate": {
                                    "sFirst": "Le premier",
                                    "sPrevious": "Le dernier",
                                    "sNext": "Suivant",
                                    "sLast": "Précédent"
                                }
                            }
                        });
                        $(".dataTables_filter input").attr("placeholder", "Rechercher");
                        dt.draw();

                    } else {
                        console.log("eng");
                        var dt = $('#dt-payout-history').DataTable({
                            destroy: true,
                            retrieve: true,                            
                            order: [[4, "asc"], [5, "desc"]]
                        });
                        dt.draw();
                    }
                });
                </script>
            }
        </div>
    </section>
</div>

@section customcss {
    <!-- Specific Page Vendor CSS -->
    <link rel="stylesheet" href="/Content/assets/vendor/select2/css/select2.css" />
    <link rel="stylesheet" href="/Content/assets/vendor/select2-bootstrap-theme/select2-bootstrap.css" />
    <link rel="stylesheet" href="/Content/assets/vendor/jquery-datatables-bs3/assets/css/datatables.css" />
}

@section VendorScripts {

    <script src="/Content/assets/vendor/select2/js/select2.js"></script>
    <script src="/Content/assets/vendor/jquery-datatables/media/js/jquery.dataTables.js"></script>
    <script src="/Content/assets/vendor/jquery-datatables/extras/TableTools/js/dataTables.tableTools.min.js"></script>
    <script src="/Content/assets/vendor/jquery-datatables-bs3/assets/js/datatables.js"></script>
}

@section Scripts {

    <!-- Examples -->
    <script src="/Content/assets/javascripts/tables/examples.datatables.default.js"></script>
}

<script type="text/javascript">
    $(window).ready(function () {
        $('#dt-payout-history').DataTable().destroy();
        var dt = $('#datatable-payout-history').DataTable({
            responsive: true,
            order: [[5, "desc"]],            
        });
        $(".dataTables_filter input").attr("placeholder", "Paghahanap");
        dt.draw();
    });
</script>